<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Earth ¬∑ Grounding Field ‚Äî 128 Hz</title>
<meta name="description" content="Earth ‚Äî a calm grounding field with a smooth 128 Hz tone, fine detune, and gentle breath pulse. Mobile-clean header with links across PLNT Earth." />
<meta name="theme-color" content="#0b0d11" media="(prefers-color-scheme: dark)">
<meta name="theme-color" content="#0b0d11">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
<style>
  :root{
    --bg:#0b0d11; --ink:#ecf1f9; --muted:#aeb4c4; --ring:#19243a; --card:#0f1525;
    --leaf:#9ee6b8; --aqua:#b5f0ea; --honey:#ffd37a;
  }
  *{box-sizing:border-box}
  html,body{margin:0;height:100%;background:radial-gradient(1200px 700px at 50% -10%, #121a2f 0%, #0b0d11 38%, #0b0d11 100%);color:var(--ink);font:16px/1.55 system-ui,-apple-system,Segoe UI,Roboto,Inter,Arial}
  a{color:inherit;text-decoration:none}
  .wrap{max-width:900px;margin:0 auto;padding:16px 16px 72px}

  /* Slim header + non-sticky ribbon (never blocks content) */
  header{padding:12px 16px 0}
  .brand{display:flex;align-items:center;gap:10px}
  .glyph{width:28px;height:28px;border-radius:8px;background:linear-gradient(135deg,#1b2639,#0f1422);display:grid;place-items:center;box-shadow:inset 0 0 0 1px #22304d}
  .glyph span{font-size:16px}
  h1{font-size:18px;margin:0 0 6px 0}
  .tag{font-size:12px;color:#c9d1e2}

  .ribbon{
    margin:10px 0 8px;display:flex;gap:8px;overflow:auto;padding-bottom:2px;
    -webkit-overflow-scrolling:touch;scrollbar-width:none
  }
  .ribbon::-webkit-scrollbar{display:none}
  .chip{
    white-space:nowrap;font-size:13px;padding:8px 12px;border-radius:999px;flex:0 0 auto;
    background:#111a31;border:1px solid #26365a;color:#e5ebfb
  }
  .chip[data-hi="1"]{border-color:#4b7a58;background:#12211b}

  /* Cards */
  .card{background:linear-gradient(180deg,#0f1525 0%, #0b101f 100%);border:1px solid var(--ring);
        border-radius:14px;padding:14px;box-shadow:0 10px 28px #0007;margin:12px 0}
  .row{display:flex;align-items:center;gap:10px;flex-wrap:wrap}
  .controls{display:grid;grid-template-columns:1fr;gap:10px}
  @media(min-width:660px){ .controls{grid-template-columns:1fr 1fr 1fr} }

  button,.pill{
    appearance:none;border:1px solid #26365a;background:#111a31;color:var(--ink);
    padding:10px 14px;border-radius:999px;font-weight:600;letter-spacing:.2px
  }
  button:active{transform:translateY(1px)}
  .on{background:linear-gradient(90deg,#1b2c21,#132418);border-color:#3f6d4e;box-shadow:0 0 0 1px #274232 inset, 0 0 20px #142a1e}
  .badge{display:inline-flex;align-items:center;gap:8px;padding:8px 12px;border-radius:999px;background:#111a31;border:1px solid #26365a;font-size:13px}

  label{font-size:13px;color:var(--muted)}
  input[type="range"]{width:100%}
  .meter{height:8px;background:#0e1426;border:1px solid #1c2a46;border-radius:999px;overflow:hidden}
  .bar{height:100%;width:0%;background:linear-gradient(90deg,#9ee6b8,#b5f0ea,#ffd37a);transition:width .35s ease}

  .note{font-size:14px;color:#cfd6ea}
  .soft{color:#b0b6c8}
  .footer{opacity:.9;text-align:center;font-size:12px;color:#aab1c6;margin-top:10px}

  /* Gentle ‚Äúalive‚Äù shimmer */
  .alive{position:relative}
  .alive:after{
    content:"";position:absolute;inset:-1px;border-radius:14px;pointer-events:none;
    background:radial-gradient(600px 160px at 20% -50%, #9ee6b822, transparent 70%),
               radial-gradient(800px 200px at 80% -60%, #b5f0ea22, transparent 75%)
  }
</style>
</head>
<body>
  <header class="wrap" aria-label="Site header">
    <div class="brand">
      <div class="glyph"><span>üåç</span></div>
      <div>
        <h1>Earth ¬∑ <span style="text-shadow:0 0 14px #9ee6b877">Grounding Field</span></h1>
        <div class="tag">128 Hz base ¬∑ fine detune ¬∑ gentle breath pulse ¬∑ mobile-clean header</div>
      </div>
    </div>

    <!-- Scrollable links across PLNT Earth -->
    <nav class="ribbon" aria-label="Sites">
      <a class="chip" href="https://mirrorhoney.plnt.earth/">MirrorHoney</a>
      <a class="chip" data-hi="1" href="https://earth.plnt.earth/">Earth</a>
      <a class="chip" href="https://honey.plnt.earth/">Honey</a>
      <a class="chip" href="https://mask.plnt.earth/">Mask</a>
      <a class="chip" href="https://voice.plnt.earth/">Voice</a>
      <a class="chip" href="https://jar.plnt.earth/">Jar</a>
      <a class="chip" href="https://froot.plnt.earth/">Froot</a>
      <a class="chip" href="https://tunes.plnt.earth/">Tunes</a>
      <a class="chip" href="https://bridge.plnt.earth/">Bridge</a>
    </nav>
  </header>

  <main class="wrap" id="main">
    <!-- Grounding Tone -->
    <section class="card alive" aria-label="Grounding tone controls">
      <div class="row" style="justify-content:space-between;gap:10px">
        <div class="badge">üåø Ground ‚Äî 128 Hz</div>
        <div class="badge">Status: <strong id="statusText">Off</strong></div>
      </div>

      <div class="row" style="margin-top:8px;gap:10px">
        <button id="startBtn" class="pill">‚ñ∂Ô∏é Start Ground</button>
        <button id="stopBtn" class="pill">‚ñ† Stop</button>
        <button id="pulseBtn" class="pill" aria-pressed="false">‚óã Pulse: Off</button>
      </div>

      <div class="controls" style="margin-top:10px">
        <div>
          <label for="volume">Level</label>
          <input id="volume" type="range" min="0" max="100" value="58" step="1" />
        </div>
        <div>
          <label for="detune">Fine Detune (¬±2%)</label>
          <input id="detune" type="range" min="-2" max="2" value="0" step="0.01" />
        </div>
        <div>
          <label for="breath">Pulse Tempo (sec / cycle)</label>
          <input id="breath" type="range" min="4" max="10" value="6" step="0.5" />
        </div>
      </div>

      <div class="meter" style="margin-top:10px"><div class="bar" id="meterBar"></div></div>

      <p class="note" style="margin-top:10px">
        Tap <b>Start Ground</b> once to unlock audio on iPhone. Soft fade-in/out prevents clicks.
        <b>Pulse</b> gently breathes the level (default ‚âà6 s cycle). Detune subtly (¬±2%) to find your easy warmth.
      </p>
    </section>

    <!-- Earth Intent -->
    <section class="card alive" aria-label="Earth intent">
      <div class="badge">üåç Field Note</div>
      <p class="note">
        Earth is the practice of **warmth ‚Üí action**. Ground for 60‚Äì90 seconds, then do one small thing that lowers harm:
        refill, repair, reuse, re-route. <i>Anyone</i> can do this. The rhythm matters more than the scale.
      </p>
      <p class="soft">Anchor: stewardship, calm, repeatable care. When the tone feels silky, ship a tiny act.</p>
    </section>

    <!-- Gentle crosslinks to Honey & Voice -->
    <section class="card" aria-label="Related">
      <div class="row" style="justify-content:space-between">
        <div class="badge">Links</div>
      </div>
      <p class="note">
        Need the sensual variant? Visit <a href="https://honey.plnt.earth/">Honey</a>.  
        Ready to speak? Move to <a href="https://voice.plnt.earth/">Voice</a>.  
        For Marina‚Äôs page, try <a href="https://mirrorhoney.plnt.earth/">MirrorHoney</a>.
      </p>
    </section>

    <div class="footer">Night-safe UI ¬∑ no overlays ¬∑ WebAudio oscillator (zero network) ¬∑ smooth ramps.</div>
  </main>

<script>
(() => {
  // Elements
  const statusText = document.getElementById('statusText');
  const startBtn = document.getElementById('startBtn');
  const stopBtn  = document.getElementById('stopBtn');
  const pulseBtn = document.getElementById('pulseBtn');
  const vol   = document.getElementById('volume');
  const det   = document.getElementById('detune');
  const breath= document.getElementById('breath');
  const bar   = document.getElementById('meterBar');

  // WebAudio nodes
  let ctx, osc, gain, lfo, lfoGain;
  let on = false, pulsing = false;

  function ensureCtx(){
    if(!ctx){
      ctx = new (window.AudioContext || window.webkitAudioContext)({latencyHint:'playback'});
      gain = ctx.createGain(); gain.gain.value = 0.0001; gain.connect(ctx.destination);
    }
  }

  function setBadge(v){ statusText.textContent = v ? 'On' : 'Off'; startBtn.classList.toggle('on', v); }
  function setPulseBadge(v){
    pulseBtn.textContent = v ? '‚óè Pulse: On' : '‚óã Pulse: Off';
    pulseBtn.setAttribute('aria-pressed', v ? 'true' : 'false');
    pulseBtn.classList.toggle('on', v);
  }

  function rampGain(target, ms){
    if(!gain) return;
    const now = ctx.currentTime;
    const dur = Math.max(0.06,(ms||250)/1000);
    const current = gain.gain.value;
    gain.gain.cancelScheduledValues(now);
    gain.gain.setValueAtTime(current, now);
    gain.gain.linearRampToValueAtTime(target, now + dur);

    // UI meter anim
    const start = parseFloat(bar.style.width)||0;
    const end = Math.round(Math.min(100, Math.max(0, target*100)));
    const t0 = performance.now(), T = Math.max(60,(ms||250));
    function step(ts){
      const k = Math.min(1,(ts - t0)/T);
      const val = Math.round(start + (end - start)*k);
      bar.style.width = val + '%';
      if(k<1) requestAnimationFrame(step);
    }
    requestAnimationFrame(step);
  }

  function targetVol(){ return Math.min(1, Math.max(0, vol.value/100)); }

  function applyDetune(){
    if(!osc) return;
    const pct = parseFloat(det.value); // ¬±2
    // Map to gentle cents: ¬±2% ‚âà ¬±34.6 cents; keep subtle ‚âà ¬±40 max
    const cents = pct * 20; // ¬±40 cents at extremes
    osc.detune.setTargetAtTime(cents, ctx.currentTime, 0.05);
  }

  function setupLFO(){
    if(lfo) return;
    lfo = ctx.createOscillator(); lfo.type = 'sine';
    lfoGain = ctx.createGain();
    // LFO controls amplitude around base level: depth ~ ¬±20% of slider
    lfoGain.gain.value = 0;
    lfo.connect(lfoGain);
    lfoGain.connect(gain.gain);
    lfo.start();
  }

  function applyBreath(){
    if(!ctx || !lfo) return;
    const seconds = parseFloat(breath.value);           // 4..10s
    const freq = 1 / seconds;                           // cycles per second
    lfo.frequency.setTargetAtTime(freq, ctx.currentTime, 0.2);
    const base = targetVol();
    // Depth ~ 20% of base volume
    const depth = base * 0.2;
    lfoGain.gain.setTargetAtTime(depth, ctx.currentTime, 0.2);
  }

  async function start(){
    ensureCtx();
    if(on) return;
    if(ctx.state === 'suspended'){ try{ await ctx.resume(); }catch(_){ } }

    osc = ctx.createOscillator();
    osc.type = 'sine';
    osc.frequency.setValueAtTime(128, ctx.currentTime);
    osc.connect(gain);
    applyDetune();
    osc.start();

    rampGain(targetVol(), 420);
    on = true; setBadge(true);
  }

  function stop(){
    if(!ctx || !osc || !on) return;
    rampGain(0.0001, 300);
    const localOsc = osc;
    setTimeout(()=>{ try{ localOsc.stop(); localOsc.disconnect(); }catch(_){} }, 320);
    on = false; setBadge(false);
  }

  function togglePulse(){
    if(!ctx) return;
    pulsing = !pulsing;
    setPulseBadge(pulsing);
    if(pulsing){
      setupLFO();
      applyBreath();
    }else{
      if(lfoGain){ lfoGain.gain.setTargetAtTime(0, ctx.currentTime, 0.2); }
    }
  }

  // Bindings
  startBtn.addEventListener('click', start);
  stopBtn .addEventListener('click', stop);
  pulseBtn.addEventListener('click', togglePulse);
  vol.addEventListener('input', () => {
    if(ctx){ rampGain(targetVol(), 140); if(pulsing) applyBreath(); }
  });
  det.addEventListener('input', applyDetune);
  breath.addEventListener('input', applyBreath);

  // Keep badge sane on visibility changes
  document.addEventListener('visibilitychange', () => setBadge(on && !document.hidden));

  // Init UI
  setBadge(false);
  setPulseBadge(false);
  bar.style.width = vol.value + '%';
})();
</script>
</body>
</html>
